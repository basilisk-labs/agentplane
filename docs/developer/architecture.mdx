---
title: "Architecture"
description: "How the CLI, backends, tasks, and recipes fit together."
---

## Overview

Agent Plane is a CLI-first workflow framework. The CLI orchestrates task state, workflow guardrails, and optional automation. Core behavior is deterministic and offline-first, while optional features are shipped as recipes.

## Core components

### CLI (`agentplane`)

- Entry point: `packages/agentplane/src/run-cli.ts`.
- Parses commands and enforces guardrails.
- Routes task operations to the configured backend.

### Core library (`@agentplane/core`)

- Project resolution and configuration parsing.
- Task README parsing and export helpers.

### Task backends

- Local backend stores tasks under `.agentplane/tasks/`.
- Remote backends (e.g., Redmine) are optional and require explicit sync.

### Recipes

- Live under `.agentplane/recipes/`.
- Provide scenarios, tools, and optional agents.
- Must comply with safety rules and I/O allowlists.

## Data flow

1. CLI reads `.agentplane/config.json`.
2. CLI resolves the active backend config.
3. Task commands read/write through the backend.
4. Exports are written to `.agentplane/tasks.json` for integrations.
5. Recipe runs write artifacts under `.agentplane/.runs/`.

## Guardrails

- Structured comments for start/block/finish actions.
- Commit subject validation with task ID suffix.
- PR artifacts required in `branch_pr` mode.

## Related docs

- [Workflow](../user/workflow)
- [Tasks and backends](../user/tasks-and-backends)
- [Backends deep dive](../user/backends)
- [Recipes spec](recipes-spec)
